












_RNvNtCsasC4v3gj2bo_13oxigraph_fuzz13result_format18fuzz_result_format:
    6|  13.8k|pub fn fuzz_result_format(format: QueryResultsFormat, data: &[u8]) {
    7|  13.8k|    let Ok(reader) = QueryResultsParser::from_format(format).parse_slice(data) else {
    8|    217|        return;
    9|       |    };
   10|  13.6k|    match reader {
   11|  13.5k|        FromSliceQueryResultsReader::Solutions(solutions) => {
   12|  13.5k|            let Ok(solutions) = solutions.collect::<Result<Vec<_>, _>>() else {
   13|  4.39k|                return;
   14|       |            };
   15|       |
   16|       |            // We try to write again
   17|  9.19k|            let mut writer = QueryResultsSerializer::from_format(format)
   18|  9.19k|                .serialize_solutions_to_write(
   19|  9.19k|                    Vec::new(),
   20|  9.19k|                    solutions
   21|  9.19k|                        .first()
   22|  9.19k|                        .map_or_else(Vec::new, |s| s.variables().to_vec()),
   23|  9.19k|                )
   24|  9.19k|                .unwrap();
   25|   861k|            for solution in &solutions {
   26|   852k|                writer.write(solution).unwrap();
   27|   852k|            }
   28|  9.19k|            let serialized = writer.finish().unwrap();
   29|       |
   30|       |            // And to parse again
   31|  9.19k|            if let FromSliceQueryResultsReader::Solutions(roundtrip_solutions) =
   32|  9.19k|                QueryResultsParser::from_format(format)
   33|  9.19k|                    .parse_slice(&serialized)
   34|  9.19k|                    .with_context(|| format!("Parsing {:?}", String::from_utf8_lossy(&serialized)))
   35|  9.19k|                    .unwrap()
   36|       |            {
   37|  9.19k|                assert_eq!(
   38|  9.19k|                    roundtrip_solutions
   39|  9.19k|                        .collect::<Result<Vec<_>, _>>()
   40|  9.19k|                        .with_context(|| format!("Parsing {serialized:?}"))
   41|  9.19k|                        .unwrap(),
   42|  9.19k|                    solutions
   43|  9.19k|                )
   44|      0|            }
   45|       |        }
   46|      7|        FromSliceQueryResultsReader::Boolean(value) => {
   47|      7|            // We try to write again
   48|      7|            let mut serialized = Vec::new();
   49|      7|            QueryResultsSerializer::from_format(format)
   50|      7|                .serialize_boolean_to_write(&mut serialized, value)
   51|      7|                .unwrap();
   52|       |
   53|       |            // And to parse again
   54|      7|            if let FromSliceQueryResultsReader::Boolean(roundtrip_value) =
   55|      7|                QueryResultsParser::from_format(format)
   56|      7|                    .parse_slice(&serialized)
   57|      7|                    .unwrap()
   58|       |            {
   59|      7|                assert_eq!(roundtrip_value, value)
   60|      0|            }
   61|       |        }
   62|       |    }
   63|  13.8k|}
_RNCNvNtCsasC4v3gj2bo_13oxigraph_fuzz13result_format18fuzz_result_format0B5_:
   22|  9.13k|                        .map_or_else(Vec::new, |s| s.variables().to_vec()),












